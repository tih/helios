	.TEXT

	ldi	@MICR,ar0
	ldi	@MICR_VALS,r0
	sti	r0,*ar0
	ldi	@MICR_VALS+1,r0
	sti	r0,*+ar0(4)

	LDI	@CONTROL_REG,AR0
	LDI	@REG_VAL,R0
	LDI	0,R7
LOOP	STI	R0,*AR0

	LDI	@WAIT_CNT,R1
WAIT	SUBI	1,R1
	BNZ	WAIT

	LDI	*AR0,R1
	CMPI	R0,R1
	BNE	ERROR
	
	B	LOOP

ERROR	LDI	0AAAAH,R7
HERE		B	HERE

CONTROL_REG	.WORD	0BFFD8000H
REG_VAL		.WORD	010040E01H
WAIT_CNT		.WORD	20

MICR			.word		0100000h
MICR_VALS		.word		01dea4000h
			.word		019cc4000h

	.END

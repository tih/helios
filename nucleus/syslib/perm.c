/* $Id: perm.c,v 1.2 1990/09/05 12:55:08 nick Exp $ */

static void permute(bits_t *src, bits_t *dst, int perm)
{
	bits_t sl,sh,dl,dh;

	switch( perm )
	{
#define PERM_IP 1
	case PERM_IP:
		sl = src[0], dl = 0;
		sh = src[1];
		dh = 0;
		if(sh & 0x02000000) dl |= 0x00000001;
		if(sh & 0x00020000) dl |= 0x00000002;
		if(sh & 0x00000200) dl |= 0x00000004;
		if(sh & 0x00000002) dl |= 0x00000008;
		if(sl & 0x02000000) dl |= 0x00000010;
		if(sl & 0x00020000) dl |= 0x00000020;
		if(sl & 0x00000200) dl |= 0x00000040;
		if(sl & 0x00000002) dl |= 0x00000080;
		if(sh & 0x08000000) dl |= 0x00000100;
		if(sh & 0x00080000) dl |= 0x00000200;
		if(sh & 0x00000800) dl |= 0x00000400;
		if(sh & 0x00000008) dl |= 0x00000800;
		if(sl & 0x08000000) dl |= 0x00001000;
		if(sl & 0x00080000) dl |= 0x00002000;
		if(sl & 0x00000800) dl |= 0x00004000;
		if(sl & 0x00000008) dl |= 0x00008000;
		if(sh & 0x20000000) dl |= 0x00010000;
		if(sh & 0x00200000) dl |= 0x00020000;
		if(sh & 0x00002000) dl |= 0x00040000;
		if(sh & 0x00000020) dl |= 0x00080000;
		if(sl & 0x20000000) dl |= 0x00100000;
		if(sl & 0x00200000) dl |= 0x00200000;
		if(sl & 0x00002000) dl |= 0x00400000;
		if(sl & 0x00000020) dl |= 0x00800000;
		if(sh & 0x80000000) dl |= 0x01000000;
		if(sh & 0x00800000) dl |= 0x02000000;
		if(sh & 0x00008000) dl |= 0x04000000;
		if(sh & 0x00000080) dl |= 0x08000000;
		if(sl & 0x80000000) dl |= 0x10000000;
		if(sl & 0x00800000) dl |= 0x20000000;
		if(sl & 0x00008000) dl |= 0x40000000;
		if(sl & 0x00000080) dl |= 0x80000000;
		if(sh & 0x01000000) dh |= 0x00000001;
		if(sh & 0x00010000) dh |= 0x00000002;
		if(sh & 0x00000100) dh |= 0x00000004;
		if(sh & 0x00000001) dh |= 0x00000008;
		if(sl & 0x01000000) dh |= 0x00000010;
		if(sl & 0x00010000) dh |= 0x00000020;
		if(sl & 0x00000100) dh |= 0x00000040;
		if(sl & 0x00000001) dh |= 0x00000080;
		if(sh & 0x04000000) dh |= 0x00000100;
		if(sh & 0x00040000) dh |= 0x00000200;
		if(sh & 0x00000400) dh |= 0x00000400;
		if(sh & 0x00000004) dh |= 0x00000800;
		if(sl & 0x04000000) dh |= 0x00001000;
		if(sl & 0x00040000) dh |= 0x00002000;
		if(sl & 0x00000400) dh |= 0x00004000;
		if(sl & 0x00000004) dh |= 0x00008000;
		if(sh & 0x10000000) dh |= 0x00010000;
		if(sh & 0x00100000) dh |= 0x00020000;
		if(sh & 0x00001000) dh |= 0x00040000;
		if(sh & 0x00000010) dh |= 0x00080000;
		if(sl & 0x10000000) dh |= 0x00100000;
		if(sl & 0x00100000) dh |= 0x00200000;
		if(sl & 0x00001000) dh |= 0x00400000;
		if(sl & 0x00000010) dh |= 0x00800000;
		if(sh & 0x40000000) dh |= 0x01000000;
		if(sh & 0x00400000) dh |= 0x02000000;
		if(sh & 0x00004000) dh |= 0x04000000;
		if(sh & 0x00000040) dh |= 0x08000000;
		if(sl & 0x40000000) dh |= 0x10000000;
		if(sl & 0x00400000) dh |= 0x20000000;
		if(sl & 0x00004000) dh |= 0x40000000;
		if(sl & 0x00000040) dh |= 0x80000000;
		dst[0] = dl;
		dst[1] = dh;
		return;
#define PERM_IPinv 2
	case PERM_IPinv:
		sl = src[0], dl = 0;
		sh = src[1];
		dh = 0;
		if(sh & 0x00000080) dl |= 0x00000001;
		if(sl & 0x00000080) dl |= 0x00000002;
		if(sh & 0x00008000) dl |= 0x00000004;
		if(sl & 0x00008000) dl |= 0x00000008;
		if(sh & 0x00800000) dl |= 0x00000010;
		if(sl & 0x00800000) dl |= 0x00000020;
		if(sh & 0x80000000) dl |= 0x00000040;
		if(sl & 0x80000000) dl |= 0x00000080;
		if(sh & 0x00000040) dl |= 0x00000100;
		if(sl & 0x00000040) dl |= 0x00000200;
		if(sh & 0x00004000) dl |= 0x00000400;
		if(sl & 0x00004000) dl |= 0x00000800;
		if(sh & 0x00400000) dl |= 0x00001000;
		if(sl & 0x00400000) dl |= 0x00002000;
		if(sh & 0x40000000) dl |= 0x00004000;
		if(sl & 0x40000000) dl |= 0x00008000;
		if(sh & 0x00000020) dl |= 0x00010000;
		if(sl & 0x00000020) dl |= 0x00020000;
		if(sh & 0x00002000) dl |= 0x00040000;
		if(sl & 0x00002000) dl |= 0x00080000;
		if(sh & 0x00200000) dl |= 0x00100000;
		if(sl & 0x00200000) dl |= 0x00200000;
		if(sh & 0x20000000) dl |= 0x00400000;
		if(sl & 0x20000000) dl |= 0x00800000;
		if(sh & 0x00000010) dl |= 0x01000000;
		if(sl & 0x00000010) dl |= 0x02000000;
		if(sh & 0x00001000) dl |= 0x04000000;
		if(sl & 0x00001000) dl |= 0x08000000;
		if(sh & 0x00100000) dl |= 0x10000000;
		if(sl & 0x00100000) dl |= 0x20000000;
		if(sh & 0x10000000) dl |= 0x40000000;
		if(sl & 0x10000000) dl |= 0x80000000;
		if(sh & 0x00000008) dh |= 0x00000001;
		if(sl & 0x00000008) dh |= 0x00000002;
		if(sh & 0x00000800) dh |= 0x00000004;
		if(sl & 0x00000800) dh |= 0x00000008;
		if(sh & 0x00080000) dh |= 0x00000010;
		if(sl & 0x00080000) dh |= 0x00000020;
		if(sh & 0x08000000) dh |= 0x00000040;
		if(sl & 0x08000000) dh |= 0x00000080;
		if(sh & 0x00000004) dh |= 0x00000100;
		if(sl & 0x00000004) dh |= 0x00000200;
		if(sh & 0x00000400) dh |= 0x00000400;
		if(sl & 0x00000400) dh |= 0x00000800;
		if(sh & 0x00040000) dh |= 0x00001000;
		if(sl & 0x00040000) dh |= 0x00002000;
		if(sh & 0x04000000) dh |= 0x00004000;
		if(sl & 0x04000000) dh |= 0x00008000;
		if(sh & 0x00000002) dh |= 0x00010000;
		if(sl & 0x00000002) dh |= 0x00020000;
		if(sh & 0x00000200) dh |= 0x00040000;
		if(sl & 0x00000200) dh |= 0x00080000;
		if(sh & 0x00020000) dh |= 0x00100000;
		if(sl & 0x00020000) dh |= 0x00200000;
		if(sh & 0x02000000) dh |= 0x00400000;
		if(sl & 0x02000000) dh |= 0x00800000;
		if(sh & 0x00000001) dh |= 0x01000000;
		if(sl & 0x00000001) dh |= 0x02000000;
		if(sh & 0x00000100) dh |= 0x04000000;
		if(sl & 0x00000100) dh |= 0x08000000;
		if(sh & 0x00010000) dh |= 0x10000000;
		if(sl & 0x00010000) dh |= 0x20000000;
		if(sh & 0x01000000) dh |= 0x40000000;
		if(sl & 0x01000000) dh |= 0x80000000;
		dst[0] = dl;
		dst[1] = dh;
		return;
#define PERM_E 3
	case PERM_E:
		sl = src[0], dl = 0;
		dh = 0;
		if(sl & 0x80000000) dl |= 0x00000001;
		if(sl & 0x00000001) dl |= 0x00000002;
		if(sl & 0x00000002) dl |= 0x00000004;
		if(sl & 0x00000004) dl |= 0x00000008;
		if(sl & 0x00000008) dl |= 0x00000010;
		if(sl & 0x00000010) dl |= 0x00000020;
		if(sl & 0x00000008) dl |= 0x00000040;
		if(sl & 0x00000010) dl |= 0x00000080;
		if(sl & 0x00000020) dl |= 0x00000100;
		if(sl & 0x00000040) dl |= 0x00000200;
		if(sl & 0x00000080) dl |= 0x00000400;
		if(sl & 0x00000100) dl |= 0x00000800;
		if(sl & 0x00000080) dl |= 0x00001000;
		if(sl & 0x00000100) dl |= 0x00002000;
		if(sl & 0x00000200) dl |= 0x00004000;
		if(sl & 0x00000400) dl |= 0x00008000;
		if(sl & 0x00000800) dl |= 0x00010000;
		if(sl & 0x00001000) dl |= 0x00020000;
		if(sl & 0x00000800) dl |= 0x00040000;
		if(sl & 0x00001000) dl |= 0x00080000;
		if(sl & 0x00002000) dl |= 0x00100000;
		if(sl & 0x00004000) dl |= 0x00200000;
		if(sl & 0x00008000) dl |= 0x00400000;
		if(sl & 0x00010000) dl |= 0x00800000;
		if(sl & 0x00008000) dl |= 0x01000000;
		if(sl & 0x00010000) dl |= 0x02000000;
		if(sl & 0x00020000) dl |= 0x04000000;
		if(sl & 0x00040000) dl |= 0x08000000;
		if(sl & 0x00080000) dl |= 0x10000000;
		if(sl & 0x00100000) dl |= 0x20000000;
		if(sl & 0x00080000) dl |= 0x40000000;
		if(sl & 0x00100000) dl |= 0x80000000;
		if(sl & 0x00200000) dh |= 0x00000001;
		if(sl & 0x00400000) dh |= 0x00000002;
		if(sl & 0x00800000) dh |= 0x00000004;
		if(sl & 0x01000000) dh |= 0x00000008;
		if(sl & 0x00800000) dh |= 0x00000010;
		if(sl & 0x01000000) dh |= 0x00000020;
		if(sl & 0x02000000) dh |= 0x00000040;
		if(sl & 0x04000000) dh |= 0x00000080;
		if(sl & 0x08000000) dh |= 0x00000100;
		if(sl & 0x10000000) dh |= 0x00000200;
		if(sl & 0x08000000) dh |= 0x00000400;
		if(sl & 0x10000000) dh |= 0x00000800;
		if(sl & 0x20000000) dh |= 0x00001000;
		if(sl & 0x40000000) dh |= 0x00002000;
		if(sl & 0x80000000) dh |= 0x00004000;
		if(sl & 0x00000001) dh |= 0x00008000;
		dst[0] = dl;
		dst[1] = dh;
		return;
#define PERM_P 4
	case PERM_P:
		sl = src[0], dl = 0;
		if(sl & 0x00008000) dl |= 0x00000001;
		if(sl & 0x00000040) dl |= 0x00000002;
		if(sl & 0x00080000) dl |= 0x00000004;
		if(sl & 0x00100000) dl |= 0x00000008;
		if(sl & 0x10000000) dl |= 0x00000010;
		if(sl & 0x00000800) dl |= 0x00000020;
		if(sl & 0x08000000) dl |= 0x00000040;
		if(sl & 0x00010000) dl |= 0x00000080;
		if(sl & 0x00000001) dl |= 0x00000100;
		if(sl & 0x00004000) dl |= 0x00000200;
		if(sl & 0x00400000) dl |= 0x00000400;
		if(sl & 0x02000000) dl |= 0x00000800;
		if(sl & 0x00000010) dl |= 0x00001000;
		if(sl & 0x00020000) dl |= 0x00002000;
		if(sl & 0x40000000) dl |= 0x00004000;
		if(sl & 0x00000200) dl |= 0x00008000;
		if(sl & 0x00000002) dl |= 0x00010000;
		if(sl & 0x00000080) dl |= 0x00020000;
		if(sl & 0x00800000) dl |= 0x00040000;
		if(sl & 0x00002000) dl |= 0x00080000;
		if(sl & 0x80000000) dl |= 0x00100000;
		if(sl & 0x04000000) dl |= 0x00200000;
		if(sl & 0x00000004) dl |= 0x00400000;
		if(sl & 0x00000100) dl |= 0x00800000;
		if(sl & 0x00040000) dl |= 0x01000000;
		if(sl & 0x00001000) dl |= 0x02000000;
		if(sl & 0x20000000) dl |= 0x04000000;
		if(sl & 0x00000020) dl |= 0x08000000;
		if(sl & 0x00200000) dl |= 0x10000000;
		if(sl & 0x00000400) dl |= 0x20000000;
		if(sl & 0x00000008) dl |= 0x40000000;
		if(sl & 0x01000000) dl |= 0x80000000;
		dst[0] = dl;
		return;
#define PERM_PC1C 5
	case PERM_PC1C:
		sl = src[0], dl = 0;
		sh = src[1];
		if(sh & 0x01000000) dl |= 0x00000001;
		if(sh & 0x00010000) dl |= 0x00000002;
		if(sh & 0x00000100) dl |= 0x00000004;
		if(sh & 0x00000001) dl |= 0x00000008;
		if(sl & 0x01000000) dl |= 0x00000010;
		if(sl & 0x00010000) dl |= 0x00000020;
		if(sl & 0x00000100) dl |= 0x00000040;
		if(sl & 0x00000001) dl |= 0x00000080;
		if(sh & 0x02000000) dl |= 0x00000100;
		if(sh & 0x00020000) dl |= 0x00000200;
		if(sh & 0x00000200) dl |= 0x00000400;
		if(sh & 0x00000002) dl |= 0x00000800;
		if(sl & 0x02000000) dl |= 0x00001000;
		if(sl & 0x00020000) dl |= 0x00002000;
		if(sl & 0x00000200) dl |= 0x00004000;
		if(sl & 0x00000002) dl |= 0x00008000;
		if(sh & 0x04000000) dl |= 0x00010000;
		if(sh & 0x00040000) dl |= 0x00020000;
		if(sh & 0x00000400) dl |= 0x00040000;
		if(sh & 0x00000004) dl |= 0x00080000;
		if(sl & 0x04000000) dl |= 0x00100000;
		if(sl & 0x00040000) dl |= 0x00200000;
		if(sl & 0x00000400) dl |= 0x00400000;
		if(sl & 0x00000004) dl |= 0x00800000;
		if(sh & 0x08000000) dl |= 0x01000000;
		if(sh & 0x00080000) dl |= 0x02000000;
		if(sh & 0x00000800) dl |= 0x04000000;
		if(sh & 0x00000008) dl |= 0x08000000;
		dst[0] = dl;
		return;
#define PERM_PC1D 6
	case PERM_PC1D:
		sl = src[0], dl = 0;
		sh = src[1];
		if(sh & 0x40000000) dl |= 0x00000001;
		if(sh & 0x00400000) dl |= 0x00000002;
		if(sh & 0x00004000) dl |= 0x00000004;
		if(sh & 0x00000040) dl |= 0x00000008;
		if(sl & 0x40000000) dl |= 0x00000010;
		if(sl & 0x00400000) dl |= 0x00000020;
		if(sl & 0x00004000) dl |= 0x00000040;
		if(sl & 0x00000040) dl |= 0x00000080;
		if(sh & 0x20000000) dl |= 0x00000100;
		if(sh & 0x00200000) dl |= 0x00000200;
		if(sh & 0x00002000) dl |= 0x00000400;
		if(sh & 0x00000020) dl |= 0x00000800;
		if(sl & 0x20000000) dl |= 0x00001000;
		if(sl & 0x00200000) dl |= 0x00002000;
		if(sl & 0x00002000) dl |= 0x00004000;
		if(sl & 0x00000020) dl |= 0x00008000;
		if(sh & 0x10000000) dl |= 0x00010000;
		if(sh & 0x00100000) dl |= 0x00020000;
		if(sh & 0x00001000) dl |= 0x00040000;
		if(sh & 0x00000010) dl |= 0x00080000;
		if(sl & 0x10000000) dl |= 0x00100000;
		if(sl & 0x00100000) dl |= 0x00200000;
		if(sl & 0x00001000) dl |= 0x00400000;
		if(sl & 0x00000010) dl |= 0x00800000;
		if(sl & 0x08000000) dl |= 0x01000000;
		if(sl & 0x00080000) dl |= 0x02000000;
		if(sl & 0x00000800) dl |= 0x04000000;
		if(sl & 0x00000008) dl |= 0x08000000;
		dst[0] = dl;
		return;
#define PERM_PC2 7
	case PERM_PC2:
		sl = src[0], dl = 0;
		sh = src[1];
		dh = 0;
		if(sl & 0x00002000) dl |= 0x00000001;
		if(sl & 0x00010000) dl |= 0x00000002;
		if(sl & 0x00000400) dl |= 0x00000004;
		if(sl & 0x00800000) dl |= 0x00000008;
		if(sl & 0x00000001) dl |= 0x00000010;
		if(sl & 0x00000010) dl |= 0x00000020;
		if(sl & 0x00000004) dl |= 0x00000040;
		if(sl & 0x08000000) dl |= 0x00000080;
		if(sl & 0x00004000) dl |= 0x00000100;
		if(sl & 0x00000020) dl |= 0x00000200;
		if(sl & 0x00100000) dl |= 0x00000400;
		if(sl & 0x00000200) dl |= 0x00000800;
		if(sl & 0x00400000) dl |= 0x00001000;
		if(sl & 0x00040000) dl |= 0x00002000;
		if(sl & 0x00000800) dl |= 0x00004000;
		if(sl & 0x00000008) dl |= 0x00008000;
		if(sl & 0x02000000) dl |= 0x00010000;
		if(sl & 0x00000080) dl |= 0x00020000;
		if(sl & 0x00008000) dl |= 0x00040000;
		if(sl & 0x00000040) dl |= 0x00080000;
		if(sl & 0x04000000) dl |= 0x00100000;
		if(sl & 0x00080000) dl |= 0x00200000;
		if(sl & 0x00001000) dl |= 0x00400000;
		if(sl & 0x00000002) dl |= 0x00800000;
		if(sh & 0x00001000) dl |= 0x01000000;
		if(sh & 0x00800000) dl |= 0x02000000;
		if(sh & 0x00000004) dl |= 0x04000000;
		if(sh & 0x00000100) dl |= 0x08000000;
		if(sh & 0x00040000) dl |= 0x10000000;
		if(sh & 0x04000000) dl |= 0x20000000;
		if(sh & 0x00000002) dl |= 0x40000000;
		if(sh & 0x00000800) dl |= 0x80000000;
		if(sh & 0x00400000) dh |= 0x00000001;
		if(sh & 0x00010000) dh |= 0x00000002;
		if(sh & 0x00000010) dh |= 0x00000004;
		if(sh & 0x00080000) dh |= 0x00000008;
		if(sh & 0x00008000) dh |= 0x00000010;
		if(sh & 0x00100000) dh |= 0x00000020;
		if(sh & 0x00000400) dh |= 0x00000040;
		if(sh & 0x08000000) dh |= 0x00000080;
		if(sh & 0x00000020) dh |= 0x00000100;
		if(sh & 0x01000000) dh |= 0x00000200;
		if(sh & 0x00020000) dh |= 0x00000400;
		if(sh & 0x00002000) dh |= 0x00000800;
		if(sh & 0x00200000) dh |= 0x00001000;
		if(sh & 0x00000080) dh |= 0x00002000;
		if(sh & 0x00000001) dh |= 0x00004000;
		if(sh & 0x00000008) dh |= 0x00008000;
		dst[0] = dl;
		dst[1] = dh;
		return;
	}
}
